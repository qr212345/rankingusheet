/* =========================
   基本スタイル
========================= */
body {
  margin:0;
  font-family: "Noto Sans JP", sans-serif;
  background: #111;
  color: #f1f1f1;
}

header {
  background: linear-gradient(90deg,#ff8a00,#e52e71);
  padding: 1rem;
  text-align: center;
  color: #fff;
}

h1, h2 { margin: 0.5rem 0; }
main {
  padding: 1rem;
  max-width: 1200px;
  margin: 0 auto;
  display: flex;
  flex-direction: column;
}

/* =========================
   コントロール
========================= */
#controls {
  display: flex; flex-wrap: wrap; gap: 1rem;
  justify-content: center; align-items: center;
  margin-top: 0.5rem;
}
#controls label, #controls button { cursor: pointer; }

/* =========================
   ランキングテーブル
========================= */
.table-wrapper {
  width: 100%;
  overflow-x: auto;
}
#rankingTable { 
  width: 100%; 
  min-width: 700px;
  border-collapse: collapse; 
  font-size: 14px; 
}
th, td {
  padding: 0.5rem; text-align: center;
  border: 1px solid #444;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}
th { background: #222; }
tr:nth-child(even) { background: #1a1a1a; }
td.admin-only { display: none; }

/* =========================
   チャート
========================= */
.charts-container { display: flex; flex-wrap: wrap; gap: 1rem; margin-bottom: 1rem; }
.charts-container canvas {
  flex:1 1 45%;
  background: #222;
  border-radius: 8px;
  min-height: 200px;
  max-height: 300px;
}
.charts-container canvas.hidden { display: none; }

/* =========================
   トースト
========================= */
#toast {
  position: fixed; bottom: 1rem; left:50%;
  transform: translateX(-50%);
  background: rgba(255,255,255,0.2); padding:0.5rem 1rem;
  border-radius: 5px; backdrop-filter: blur(5px);
  transition: all 0.3s; opacity:1; z-index:1000;
}
#toast.hidden { opacity:0; pointer-events:none; }

/* =========================
   称号カードセクション余白調整
========================= */
section#titleSection {
  margin-top: 2rem;
  margin-bottom: 3rem;
  padding: 0 1rem;
}

/* =========================
   称号カード グリッド改善
========================= */
#titleCatalog {
  display: grid;
  gap: 20px;
  justify-content: center;
  padding: 1rem 0;
  max-height: 60vh;       /* ランキング表伸長時にスクロール */
  overflow-y: auto;
  scroll-behavior: smooth;
}

/* =========================
   称号カード 個別改善
========================= */
.title-card-container {
  perspective: 1000px;
  margin: 0 auto;
}
.title-card {
  width: 150px;
  height: 200px;
  position: relative;
  transform-style: preserve-3d;
  transition: transform 0.8s;
  cursor: pointer;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  margin: 0 auto;
}
.title-card .front, .title-card .back {
  position: absolute; width:100%; height:100%;
  backface-visibility: hidden;
  display:flex; flex-direction:column; justify-content:center; align-items:center;
  border-radius: 12px; padding: 0.75rem; text-align:center;
  box-shadow: 0 4px 8px rgba(0,0,0,0.5);
  overflow-wrap: break-word;
}
.title-card .front { background: #555; color:#ccc; }
.title-card .back { transform: rotateY(180deg); color:#fff; font-weight:bold; }

/* =========================
   カード回転獲得アニメ
========================= */
.title-card.gain { transform: rotateY(180deg); transition: transform 0.8s ease-in-out; }

/* =========================
   レアリティ背景
========================= */
.rare-bronze { background: radial-gradient(circle,#cd7f32,#8b4513); }
.rare-silver { background: radial-gradient(circle,#c0c0c0,#888); }
.rare-gold { background: radial-gradient(circle,#ffd700,#ffb700); }
.rare-rainbow { background: conic-gradient(red,orange,yellow,green,blue,indigo,violet); }

/* =========================
   パーティクル
========================= */
.particle-container {
  position: absolute; top:0; left:0; width:100%; height:100%; pointer-events:none;
}
.particle {
  position:absolute; width:6px; height:6px; border-radius:50%;
  animation: float 1s linear forwards;
}
@keyframes float {
  0%{opacity:1; transform:translate(0,0);}
  100%{opacity:0; transform:translate(var(--dx,50px),var(--dy,100px)) scale(0.3);}
}

/* =========================
   ポップアップ
========================= */
.title-popup {
  position: fixed; top:50%; left:50%; transform:translate(-50%,-50%);
  background:#222; padding:1rem; border-radius:8px;
  text-align:center; opacity:0; transition: opacity 0.3s;
  z-index:1001;
}
.title-popup.show { opacity:1; }
.title-detail-overlay {
  position: fixed; top:0; left:0; width:100%; height:100%;
  background: rgba(0,0,0,0.7); display:flex; justify-content:center; align-items:center;
  z-index:1002;
}
.title-detail-popup {
  background:#333; padding:2rem; border-radius:12px; text-align:center; max-width:300px;
}
.title-detail-popup button { margin-top:1rem; cursor:pointer; padding:0.5rem 1rem; border:none; border-radius:5px; background: #e52e71; color:#fff; font-weight:bold; }

/* =========================
   フィルタ入力
========================= */
#titleFilters { display:flex; gap:1rem; margin-bottom:1rem; flex-wrap:wrap; justify-content:center; }
#titleFilters input, #titleFilters select { padding:0.3rem 0.5rem; border-radius:5px; border:none; }

/* =========================
   レスポンシブ
========================= */
@media (max-width: 1024px) {
  #titleCatalog { gap: 16px; max-height:50vh; }
  .title-card { width: 130px; height:180px; }
}

@media (max-width: 768px) {
  .charts-container { flex-direction: column; }
  .charts-container canvas { flex:1 1 100%; height:200px; }
  .title-card { width: 120px; height:160px; }
  #rankingTable th, #rankingTable td { font-size: 12px; padding:0.3rem; }
  .particle-container .particle { width:4px; height:4px; }
}

@media (max-width: 480px) {
  header { font-size: 1rem; }
  #titleCatalog { gap:10px; max-height:40vh; }
  .title-card { width:100px; height:140px; }
  .title-card .front, .title-card .back { font-size:0.8rem; }
  #rankingTable th, #rankingTable td { font-size:11px; padding:0.2rem; }
  .title-card.gain { transition: none; }
}
